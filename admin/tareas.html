<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion de Tareas | Panel de Administracion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .admin-header { background: linear-gradient(135deg, #c53030, #9b2c2c); }
        .admin-badge { background: #c53030; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; margin-left: 0.5rem; }
        .task-card { padding: var(--spacing-md); border: 1px solid var(--border-color); border-radius: var(--border-radius-md); margin-bottom: var(--spacing-sm); }
        .task-card:hover { background: var(--bg-light); }
        .session-group { margin-bottom: 2rem; }
        .session-group-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--primary-color); color: white; border-radius: var(--border-radius-md) var(--border-radius-md) 0 0; }
        .session-group-content { border: 1px solid var(--border-color); border-top: none; border-radius: 0 0 var(--border-radius-md) var(--border-radius-md); padding: 1rem; }
    </style>
</head>
<body>
    <header class="header admin-header">
        <div class="header-main">
            <div class="container">
                <a href="../index.html" class="logo">
                    <div class="logo-icon">C2</div>
                    <div class="logo-text">
                        <span class="logo-title">Panel de Administracion <span class="admin-badge">ADMIN</span></span>
                        <span class="logo-subtitle">CLM - UGR</span>
                    </div>
                </a>
                <nav class="nav-main"><a href="../index.html">Ver curso</a><a href="../sesiones/index.html">Sesiones</a></nav>
                <div class="nav-auth"></div>
            </div>
        </div>
    </header>

    <main class="section">
        <div class="container">
            <div class="page-with-sidebar">
                <aside class="sidebar">
                    <div class="sidebar-section">
                        <h4 class="sidebar-title">Administracion</h4>
                        <ul class="sidebar-nav">
                            <li><a href="index.html">Panel principal</a></li>
                            <li><a href="estudiantes.html">Estudiantes</a></li>
                            <li><a href="correcciones.html">Correcciones</a></li>
                            <li><a href="notificaciones.html">Notificaciones</a></li>
                            <li><a href="tareas.html" class="active">Gestion de tareas</a></li>
                            <li><a href="estadisticas.html">Estadisticas</a></li>
                            <li><a href="comparacion.html">Comparacion</a></li>
                            <li><a href="rubricas.html">ðŸ“Š RÃºbricas</a></li>
                            <li><a href="boletines.html">ðŸ“‹ Boletines</a></li>
                        </ul>
                    </div>
                    <div class="sidebar-section">
                        <button onclick="PE.Auth.logout()" class="btn btn-outline btn-block">Cerrar sesion</button>
                    </div>
                </aside>

                <div class="main-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-xl);">
                        <div>
                            <h1 style="margin-bottom: 0.25rem;">Gestion de tareas</h1>
                            <p class="text-secondary mb-0">Control de actividades y entregas por sesion</p>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-primary" onclick="showCreateTaskModal()">
                                + Nueva tarea
                            </button>
                        </div>
                    </div>

                    <!-- PestaÃ±as para cambiar entre entregas y tareas -->
                    <div class="card mb-4">
                        <div class="card-body">
                            <div style="display: flex; gap: var(--spacing-md);">
                                <button class="btn btn-primary" id="tab-entregas" onclick="switchTab('entregas')">
                                    Entregas de estudiantes
                                </button>
                                <button class="btn btn-outline" id="tab-tareas" onclick="switchTab('tareas')">
                                    Tareas administrativas
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Resumen de tareas -->
                    <div class="sessions-grid mb-4" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="card text-center" style="padding: 1.5rem;">
                            <h3 class="text-primary" style="font-size: 2rem; margin: 0;" id="stat-total">0</h3>
                            <p class="text-secondary mb-0">Total entregas</p>
                        </div>
                        <div class="card text-center" style="padding: 1.5rem;">
                            <h3 style="font-size: 2rem; margin: 0; color: var(--warning-color);" id="stat-pending">0</h3>
                            <p class="text-secondary mb-0">Pendientes</p>
                        </div>
                        <div class="card text-center" style="padding: 1.5rem;">
                            <h3 style="font-size: 2rem; margin: 0; color: var(--success-color);" id="stat-reviewed">0</h3>
                            <p class="text-secondary mb-0">Corregidas</p>
                        </div>
                        <div class="card text-center" style="padding: 1.5rem;">
                            <h3 class="text-primary" style="font-size: 2rem; margin: 0;" id="stat-sessions">0</h3>
                            <p class="text-secondary mb-0">Sesiones activas</p>
                        </div>
                    </div>

                    <!-- Contenido de Entregas de Estudiantes -->
                    <div id="entregas-content">
                        <!-- Filtro por sesion -->
                    <div class="card mb-4">
                        <div class="card-body">
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                                <select id="filter-session" class="form-control form-select" style="flex: 1; min-width: 200px;">
                                    <option value="">Todas las sesiones</option>
                                </select>
                                <select id="filter-status" class="form-control form-select" style="width: auto;">
                                    <option value="">Todos los estados</option>
                                    <option value="pending">Pendientes</option>
                                    <option value="reviewed">Corregidas</option>
                                </select>
                                <button class="btn btn-outline" onclick="exportSessionData()">Exportar datos</button>
                            </div>
                        </div>
                    </div>

                    <!-- Lista de tareas por sesion -->
                    <div id="tasks-list">
                        <div class="loader"></div>
                    </div>
                    </div>

                    <!-- Contenido de Tareas Administrativas -->
                    <div id="tareas-content" style="display: none;">
                        <!-- EstadÃ­sticas de tareas administrativas -->
                        <div class="sessions-grid mb-4" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="card text-center" style="padding: 1.5rem;">
                                <h3 class="text-primary" style="font-size: 2rem; margin: 0;" id="stat-admin-total">0</h3>
                                <p class="text-secondary mb-0">Total tareas</p>
                            </div>
                            <div class="card text-center" style="padding: 1.5rem;">
                                <h3 style="font-size: 2rem; margin: 0; color: var(--success-color);" id="stat-admin-completed">0</h3>
                                <p class="text-secondary mb-0">Completadas</p>
                            </div>
                            <div class="card text-center" style="padding: 1.5rem;">
                                <h3 style="font-size: 2rem; margin: 0; color: var(--warning-color);" id="stat-admin-pending">0</h3>
                                <p class="text-secondary mb-0">Pendientes</p>
                            </div>
                        </div>

                        <!-- Filtro de tareas administrativas -->
                        <div class="card mb-4">
                            <div class="card-body">
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                                    <select id="filter-admin-status" class="form-control form-select" style="width: auto;">
                                        <option value="">Todos los estados</option>
                                        <option value="pending">Pendientes</option>
                                        <option value="in_progress">En progreso</option>
                                        <option value="completed">Completadas</option>
                                    </select>
                                    <select id="filter-admin-priority" class="form-control form-select" style="width: auto;">
                                        <option value="">Todas las prioridades</option>
                                        <option value="high">Alta</option>
                                        <option value="medium">Media</option>
                                        <option value="low">Baja</option>
                                    </select>
                                    <button class="btn btn-outline" onclick="exportTasks()">Exportar tareas</button>
                                </div>
                            </div>
                        </div>

                        <!-- Lista de tareas administrativas -->
                        <div class="card">
                            <div class="card-body">
                                <div id="admin-tasks-list">
                                    <div class="text-center text-secondary">
                                        <p>No hay tareas administrativas.</p>
                                        <button class="btn btn-primary mt-3" onclick="showCreateTaskModal()">+ Crear primera tarea</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom" style="border:none;padding-top:0;">
                <span>&copy; 2026 Javier Benitez Lainez | CLM - UGR</span>
            </div>
        </div>
    </footer>

    <script>
        window.PE_CONFIG = {
            API_URL: 'https://produccion-escrita-c2-api-production.up.railway.app'
        };
    </script>
    <script src="../js/config.js"></script>
<script src="../js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const user = await PE.Auth.checkSession();
            if (!user || user.role !== 'admin') {
                const basePath = window.location.pathname.includes('/PE/') ? '/PE' : '';
                window.location.href = basePath + '/auth/login.html';
                return;
            }

            let submissions = await PE.Submissions.getAll();

            submissions = Array.isArray(submissions) ? submissions : [];
            const sessions = PE.CourseData.sessions;
            const pending = submissions.filter(s => s.status === 'pending');
            const reviewed = submissions.filter(s => s.status === 'reviewed');

            // Estadisticas
            document.getElementById('stat-total').textContent = submissions.length;
            document.getElementById('stat-pending').textContent = pending.length;
            document.getElementById('stat-reviewed').textContent = reviewed.length;

            // Sesiones con entregas
            const sessionsWithSubmissions = new Set(submissions.map(s => s.sessionId));
            document.getElementById('stat-sessions').textContent = sessionsWithSubmissions.size;

            // Poblar selector de sesiones
            const sessionSelect = document.getElementById('filter-session');
            sessions.forEach(s => {
                const count = submissions.filter(sub => sub.sessionId == s.id).length;
                const option = document.createElement('option');
                option.value = s.id;
                option.textContent = `Sesion ${s.id}: ${s.title} (${count} entregas)`;
                sessionSelect.appendChild(option);
            });

            function renderTasks(filter = {}) {
                let filtered = [...submissions];

                if (filter.session) {
                    filtered = filtered.filter(s => s.sessionId == filter.session);
                }

                if (filter.status) {
                    filtered = filtered.filter(s => s.status === filter.status);
                }

                const container = document.getElementById('tasks-list');

                if (filtered.length === 0) {
                    container.innerHTML = '<div class="card"><div class="card-body text-center"><p class="text-secondary">No hay entregas con los filtros seleccionados.</p></div></div>';
                    return;
                }

                // Agrupar por sesion
                const grouped = {};
                filtered.forEach(s => {
                    const sessionId = s.sessionId || 'sin-sesion';
                    if (!grouped[sessionId]) grouped[sessionId] = [];
                    grouped[sessionId].push(s);
                });

                let html = '';
                Object.keys(grouped).sort((a, b) => parseInt(a) - parseInt(b)).forEach(sessionId => {
                    const session = sessions.find(s => s.id == sessionId);
                    const sessionSubmissions = grouped[sessionId];
                    const sessionPending = sessionSubmissions.filter(s => s.status === 'pending').length;

                    html += `
                        <div class="session-group">
                            <div class="session-group-header">
                                <div>
                                    <strong>Sesion ${sessionId}</strong>: ${session ? session.title : 'Sesion no identificada'}
                                </div>
                                <div>
                                    <span class="badge" style="background: rgba(255,255,255,0.2);">${sessionSubmissions.length} entregas</span>
                                    ${sessionPending > 0 ? `<span class="badge badge-warning" style="margin-left: 0.5rem;">${sessionPending} pendientes</span>` : ''}
                                </div>
                            </div>
                            <div class="session-group-content">
                                ${sessionSubmissions.map(s => `
                                    <div class="task-card">
                                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                            <div>
                                                <strong>${PE.Utils.escapeHtml(s.userName || 'Estudiante')}</strong>
                                                <span class="badge badge-${s.status === 'reviewed' ? 'success' : 'warning'}" style="margin-left: 0.5rem;">
                                                    ${s.status === 'reviewed' ? 'Corregido' : 'Pendiente'}
                                                </span>
                                                <p class="text-secondary mb-0" style="font-size: 0.875rem; margin-top: 0.25rem;">
                                                    ${PE.Utils.escapeHtml(s.activityTitle)} - ${s.wordCount} palabras
                                                </p>
                                                <p class="text-secondary mb-0" style="font-size: 0.8rem;">
                                                    Entregado: ${PE.Utils.formatDate(s.createdAt, 'long')}
                                                </p>
                                            </div>
                                            <div>
                                                ${s.status === 'pending' ?
                                                    `<a href="correcciones.html" class="btn btn-sm btn-primary">Corregir</a>` :
                                                    `<button class="btn btn-sm btn-outline" onclick="viewSubmission('${s.id}')">Ver</button>`
                                                }
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            renderTasks();

            // Filtros
            document.getElementById('filter-session').addEventListener('change', (e) => {
                renderTasks({
                    session: e.target.value,
                    status: document.getElementById('filter-status').value
                });
            });

            document.getElementById('filter-status').addEventListener('change', (e) => {
                renderTasks({
                    session: document.getElementById('filter-session').value,
                    status: e.target.value
                });
            });
        });

        async function viewSubmission(id) {
            let submissions = await PE.Submissions.getAll();
            submissions = Array.isArray(submissions) ? submissions : [];
            const targetId = String(id);
            const s = submissions.find(sub => String(sub.id) === targetId);
            if (s) {
                PE.UI.showModal(s.activityTitle, `
                    <div class="mb-3">
                        <strong>Estudiante:</strong> ${PE.Utils.escapeHtml(s.userName || 'Estudiante')}
                    </div>
                    <div class="mb-3">
                        <strong>Entregado:</strong> ${PE.Utils.formatDate(s.createdAt, 'long')}
                    </div>
                    <div class="mb-3">
                        <strong>Contenido:</strong>
                        <div style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; max-height: 200px; overflow-y: auto; margin-top: 0.5rem;">
                            ${s.content}
                        </div>
                        <p class="text-secondary" style="font-size: 0.8rem; margin-top: 0.5rem;">${s.wordCount} palabras</p>
                    </div>
                    ${s.feedback ? `
                        <div class="alert alert-success">
                            <strong>Retroalimentacion:</strong>
                            <p style="margin: 0.5rem 0 0;">${PE.Utils.escapeHtml(s.feedback)}</p>
                            ${s.grade ? `<p style="margin: 0.5rem 0 0;"><strong>Calificacion:</strong> ${s.grade}</p>` : ''}
                        </div>
                    ` : ''}
                `, [{ text: 'Cerrar' }]);
            }
        }

        async function exportSessionData() {
            let submissions = await PE.Submissions.getAll();
            submissions = Array.isArray(submissions) ? submissions : [];
            const sessions = PE.CourseData.sessions;

            const data = sessions.map(session => {
                const sessionSubmissions = submissions.filter(s => s.sessionId == session.id);
                return {
                    sesion: session.id,
                    titulo: session.title,
                    fecha: session.date,
                    entregas: sessionSubmissions.length,
                    pendientes: sessionSubmissions.filter(s => s.status === 'pending').length,
                    corregidas: sessionSubmissions.filter(s => s.status === 'reviewed').length
                };
            });

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tareas_por_sesion_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();

            PE.UI.notify('Datos exportados correctamente', 'success');
        }

        // Funciones para gestiÃ³n de tareas administrativas
        let adminTasks = JSON.parse(localStorage.getItem('pe_admin_tasks') || '[]');

        function switchTab(tab) {
            const entregasContent = document.getElementById('entregas-content');
            const tareasContent = document.getElementById('tareas-content');
            const tabEntregas = document.getElementById('tab-entregas');
            const tabTareas = document.getElementById('tab-tareas');

            if (tab === 'entregas') {
                entregasContent.style.display = 'block';
                tareasContent.style.display = 'none';
                tabEntregas.className = 'btn btn-primary';
                tabTareas.className = 'btn btn-outline';
            } else {
                entregasContent.style.display = 'none';
                tareasContent.style.display = 'block';
                tabEntregas.className = 'btn btn-outline';
                tabTareas.className = 'btn btn-primary';
                renderAdminTasks();
            }
        }

        function renderAdminTasks(filter = {}) {
            let filtered = [...adminTasks];

            if (filter.status) {
                filtered = filtered.filter(t => t.status === filter.status);
            }

            if (filter.priority) {
                filtered = filtered.filter(t => t.priority === filter.priority);
            }

            const container = document.getElementById('admin-tasks-list');
            const completed = adminTasks.filter(t => t.status === 'completed').length;
            const pending = adminTasks.filter(t => t.status !== 'completed').length;

            document.getElementById('stat-admin-total').textContent = adminTasks.length;
            document.getElementById('stat-admin-completed').textContent = completed;
            document.getElementById('stat-admin-pending').textContent = pending;

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-secondary">
                        <p>No hay tareas administrativas ${Object.keys(filter).length > 0 ? 'con los filtros seleccionados' : ''}.</p>
                        <button class="btn btn-primary mt-3" onclick="showCreateTaskModal()">+ Crear tarea</button>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(task => {
                const priorityColors = {
                    high: 'danger',
                    medium: 'warning',
                    low: 'secondary'
                };
                const priorityLabels = {
                    high: 'Alta',
                    medium: 'Media',
                    low: 'Baja'
                };
                const statusColors = {
                    pending: 'warning',
                    in_progress: 'primary',
                    completed: 'success'
                };
                const statusLabels = {
                    pending: 'Pendiente',
                    in_progress: 'En progreso',
                    completed: 'Completada'
                };

                return `
                    <div class="task-card" style="border-left: 4px solid var(--${priorityColors[task.priority]}-color);">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.5rem;">
                                    <strong>${PE.Utils.escapeHtml(task.title)}</strong>
                                    <span class="badge badge-${priorityColors[task.priority]}">${priorityLabels[task.priority]}</span>
                                    <span class="badge badge-${statusColors[task.status]}">${statusLabels[task.status]}</span>
                                </div>
                                <p class="text-secondary mb-0" style="font-size: 0.875rem;">${PE.Utils.escapeHtml(task.description)}</p>
                                ${task.dueDate ? `<p class="text-secondary mb-0" style="font-size: 0.8rem; margin-top: 0.5rem;">ðŸ“… Fecha lÃ­mite: ${new Date(task.dueDate).toLocaleDateString('es-ES')}</p>` : ''}
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                ${task.status !== 'completed' ?
                                    `<button class="btn btn-sm btn-outline" onclick="toggleTaskStatus('${task.id}')">
                                        ${task.status === 'pending' ? 'â–¶' : 'âœ“'}
                                    </button>` :
                                    '<span class="text-secondary">âœ“</span>'
                                }
                                <button class="btn btn-sm btn-outline" onclick="deleteTask('${task.id}')">ðŸ—‘</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showCreateTaskModal() {
            const sessions = PE.CourseData.sessions;
            const sessionsOptions = sessions.map(s =>
                `<option value="${s.id}">SesiÃ³n ${s.id}: ${s.title}</option>`
            ).join('');

            PE.UI.showModal('Crear nueva tarea administrativa', `
                <form id="create-task-form" onsubmit="createTask(event)">
                    <div class="form-group">
                        <label class="form-label">TÃ­tulo *</label>
                        <input type="text" name="title" class="form-control" required placeholder="Ej: Revisar correcciones de la sesiÃ³n 5">
                    </div>
                    <div class="form-group">
                        <label class="form-label">DescripciÃ³n *</label>
                        <textarea name="description" class="form-control" rows="3" required placeholder="Describe la tarea..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Prioridad *</label>
                        <select name="priority" class="form-control form-select" required>
                            <option value="high">Alta</option>
                            <option value="medium" selected>Media</option>
                            <option value="low">Baja</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Fecha lÃ­mite (opcional)</label>
                        <input type="date" name="dueDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="form-label">SesiÃ³n relacionada (opcional)</label>
                        <select name="sessionId" class="form-control form-select">
                            <option value="">Sin sesiÃ³n especÃ­fica</option>
                            ${sessionsOptions}
                        </select>
                    </div>
                    <div style="display: flex; gap: var(--spacing-sm); margin-top: var(--spacing-md);">
                        <button type="submit" class="btn btn-primary">Crear tarea</button>
                        <button type="button" class="btn btn-outline" onclick="PE.UI.closeModal()">Cancelar</button>
                    </div>
                </form>
            `);
        }

        async function createTask(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);

            const task = {
                id: 'task_' + Date.now(),
                title: formData.get('title'),
                description: formData.get('description'),
                priority: formData.get('priority'),
                status: 'pending',
                dueDate: formData.get('dueDate') || null,
                sessionId: formData.get('sessionId') || null,
                createdAt: new Date().toISOString(),
                createdBy: 'admin'
            };

            adminTasks.push(task);
            localStorage.setItem('pe_admin_tasks', JSON.stringify(adminTasks));

            PE.UI.closeModal();
            PE.UI.notify('Tarea creada correctamente', 'success');
            renderAdminTasks();

            // Si la API estÃ¡ disponible, enviar a backend
            try {
                const API = PE.API;
                await API.post('/admin/tasks', task);
            } catch (e) {
                console.log('Tarea guardada solo en localStorage (API no disponible)');
            }
        }

        function toggleTaskStatus(taskId) {
            const task = adminTasks.find(t => t.id === taskId);
            if (task) {
                if (task.status === 'pending') {
                    task.status = 'in_progress';
                } else if (task.status === 'in_progress') {
                    task.status = 'completed';
                    task.completedAt = new Date().toISOString();
                } else {
                    task.status = 'pending';
                    delete task.completedAt;
                }

                localStorage.setItem('pe_admin_tasks', JSON.stringify(adminTasks));
                renderAdminTasks();
                PE.UI.notify('Estado de tarea actualizado', 'success');
            }
        }

        function deleteTask(taskId) {
            if (confirm('Â¿EstÃ¡s seguro de que quieres eliminar esta tarea?')) {
                adminTasks = adminTasks.filter(t => t.id !== taskId);
                localStorage.setItem('pe_admin_tasks', JSON.stringify(adminTasks));
                renderAdminTasks();
                PE.UI.notify('Tarea eliminada', 'success');
            }
        }

        async function exportTasks() {
            const data = adminTasks.map(task => ({
                titulo: task.title,
                descripcion: task.description,
                prioridad: task.priority,
                estado: task.status,
                fecha_limite: task.dueDate,
                sesion: task.sessionId,
                creada: task.createdAt
            }));

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tareas_administrativas_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();

            PE.UI.notify('Tareas exportadas correctamente', 'success');
        }

        // Event listeners para filtros de tareas administrativas
        document.addEventListener('DOMContentLoaded', () => {
            const filterStatus = document.getElementById('filter-admin-status');
            const filterPriority = document.getElementById('filter-admin-priority');

            if (filterStatus) {
                filterStatus.addEventListener('change', () => {
                    renderAdminTasks({
                        status: filterStatus.value,
                        priority: filterPriority.value
                    });
                });
            }

            if (filterPriority) {
                filterPriority.addEventListener('change', () => {
                    renderAdminTasks({
                        status: filterStatus.value,
                        priority: filterPriority.value
                    });
                });
            }
        });
    </script>
</body>
</html>
